auca_database=# \dt
Did not find any relations.
auca_database=# CREATE TABLE employees (
    employee_id SERIAL PRIMARY KEY,
    first_name VARCHAR(50),
    last_name VARCHAR(50),
    department VARCHAR(100),
    department_id INTEGER,
    salary DECIMAL(10,2),
    age INTEGER,
    hire_date DATE,
    bonus DECIMAL(10,2),
    experience_years INTEGER,
    email VARCHAR(100)
);
CREATE TABLE
auca_database=# CREATE TABLE sales (
    sale_id SERIAL PRIMARY KEY,
    employee_id INTEGER REFERENCES employees(employee_id),
    amount DECIMAL(10,2),
    sale_date DATE DEFAULT CURRENT_DATE
);
CREATE TABLE
auca_database=# CREATE TABLE employee_skills (
    employee_id INTEGER REFERENCES employees(employee_id),
    skill_name VARCHAR(100)
auca_database=# INSERT INTO employees (first_name, last_name, depauca_database=# INSERT INTO employees (first_name, last_name, department, department_id, salary, age, hire_date, bonus, experience_years, email) VALUES
('Alice', 'Brown', 'Engineering', 1, 120000, 34, '2020-02-01', 5000, 8, 'alice@company.com'),
('Bob', 'Smith', 'Engineering', 1, 95000, 29, '2021-05-15', NULL, 5, 'bob@company.com'),
('Charlie', 'Davis', 'Sales', 2, 70000, 40, '2018-07-10', 2000, 12, 'charlie@company.com'),
('Diana', 'Evans', 'Sales', 2, 65000, 36, '2022-03-12', 1500, 10, NULL),
('Ethan', 'Green', 'Marketing', 3, 55000, 31, '2023-01-25', 1000, 6, 'ethan@company.com'),
('Fiona', 'White', 'Marketing', 3, 72000, 27, '2023-06-10', NULL, 3, 'fiona@company.com'),
('George', 'King', 'Engineering', 1, 130000, 45, '2015-09-01', 7000, 20, 'george@company.com'),
('Hannah', 'Lee', 'HR', 4, 60000, 42, '2017-04-15', NULL, 18, 'hannah@company.com');
INSERT 0 8
auca_database=# INSERT INTO sales (employee_id, amount, sale_date) VALUES
(3, 1500, '2024-01-15'),
(3, 2300, '2024-02-12'),
(4, 1800, '2024-03-09'),
(4, 900,  '2024-03-18'),
(2, 2200, '2024-04-01');
INSERT 0 5
auca_database=# INSERT INTO employee_skills (employee_id, skill_name) VALUES
(1, 'Python'),
(1, 'SQL'),
(1, 'Machine Learning'),
(2, 'Java'),
(2, 'SQL'),
(3, 'Negotiation'),
(3, 'Communication'),
(4, 'Salesforce'),
(5, 'Social Media'),
(6, 'SEO'),
(7, 'C++'),
(7, 'Leadership'),
(8, 'Recruitment');
INSERT 0 13
auca_database=# INSERT INTO products (category, product_name, price, rating) VALUES
('Electronics', 'Smartphone', 800, 4.5),
('Electronics', 'Laptop', 1200, 4.7),
('Home', 'Vacuum Cleaner', 300, 4.2),
('Home', 'Air Purifier', 250, 4.1),
('Food', 'Chocolate Bar', 2.5, 4.8),
('Food', 'Protein Shake', 3.5, 4.3);
INSERT 0 6
auca_database=# INSERT INTO product_reviews (product_id, rating) VALUES
(1, 4.7),
(1, 4.8),
(2, 4.6),
(2, 4.9),
(3, 3.8),
(4, 4.0),
(5, 4.9),
(6, 4.5);
INSERT 0 8
auca_database=# \dt
            List of relations
 Schema |      Name       | Type  | Owner
--------+-----------------+-------+-------
 public | employee_skills | table | arsen
 public | employees       | table | arsen
 public | product_reviews | table | arsen
 public | products        | table | arsen
 public | sales           | table | arsen
(5 rows)

auca_database=# SELECT COUNT(*) AS total_employees
FROM employees;
 total_employees
-----------------
               8
(1 row)

auca_database=# SELECT COUNT(email) AS employees_with_email
FROM employees;
 employees_with_email
----------------------
                    7
(1 row)

auca_database=# SELECT COUNT(DISTINCT department) AS unique_departments
FROM employees;
 unique_departments
--------------------
                  4
(1 row)

auca_database=# SELECT SUM(salary) AS total_salaries
FROM employees;
 total_salaries
----------------
      667000.00
(1 row)

auca_database=# SELECT department, SUM(sales_amount) AS total_sales
FROM sales_data
GROUP BY department;
ERROR:  relation "sales_data" does not exist
LINE 2: FROM sales_data
             ^
auca_database=# SELECT SUM(salary) AS total_salaries
FROM employees;
-- Calculate total sales by department
SELECT department, SUM(sales_amount) AS total_sales
FROM sales_data
GROUP BY department;
 total_salaries
----------------
      667000.00
(1 row)

ERROR:  relation "sales_data" does not exist
LINE 2: FROM sales_data
             ^
auca_database=# CREATE TABLE sales_data (
    department VARCHAR(100),
    sales_amount DECIMAL(10,2)
);
CREATE TABLE
auca_database=# INSERT INTO sales_data (department, sales_amount) VALUES
('Sales', 1500),
('Sales', 2300),
('Sales', 1800),
('Sales', 900),
('Engineering', 2200),
('Marketing', 1500),
('Engineering', 1200);
INSERT 0 7
auca_database=# SELECT SUM(salary) AS total_salaries
FROM employees;
 total_salaries
----------------
      667000.00
(1 row)

auca_database=# SELECT department, SUM(sales_amount) AS total_sales
FROM sales_data
GROUP BY department;
 department  | total_sales
-------------+-------------
 Marketing   |     1500.00
 Engineering |     3400.00
 Sales       |     6500.00
(3 rows)

auca_database=# SELECT AVG(salary) AS average_salary
FROM employees;
   average_salary
--------------------
 83375.000000000000
(1 row)

auca_database=# SELECT department, AVG(age) AS avg_age
FROM employees
GROUP BY department;
 department  |       avg_age
-------------+---------------------
 Engineering | 36.0000000000000000
 Marketing   | 29.0000000000000000
 Sales       | 38.0000000000000000
 HR          | 42.0000000000000000
(4 rows)

auca_database=# SELECT
    MAX(salary) AS highest_salary,
    MIN(salary) AS lowest_salary
FROM employees;
 highest_salary | lowest_salary
----------------+---------------
      130000.00 |      55000.00
(1 row)

auca_database=# SELECT department, MAX(hire_date) AS latest_hire
FROM employees
GROUP BY department;
 department  | latest_hire
-------------+-------------
 Engineering | 2021-05-15
 Marketing   | 2023-06-10
 Sales       | 2022-03-12
 HR          | 2017-04-15
(4 rows)

auca_database=# SELECT department, STRING_AGG(first_name, ', ') AS employee_names
FROM employees
GROUP BY department;
 department  |   employee_names
-------------+--------------------
 Engineering | Alice, Bob, George
 Marketing   | Ethan, Fiona
 Sales       | Charlie, Diana
 HR          | Hannah
(4 rows)

auca_database=# SELECT employee_id, STRING_AGG(skill_name, ', ' ORDER BY skill_name) AS skills
FROM employee_skills
GROUP BY employee_id;
 employee_id |            skills
-------------+-------------------------------
           1 | Machine Learning, Python, SQL
           2 | Java, SQL
           3 | Communication, Negotiation
           4 | Salesforce
           5 | Social Media
           6 | SEO
           7 | C++, Leadership
           8 | Recruitment
(8 rows)

auca_database=# SELECT department, ARRAY_AGG(salary) AS salary_array
FROM employees
GROUP BY department;
 department  |          salary_array
-------------+--------------------------------
 Engineering | {120000.00,95000.00,130000.00}
 Marketing   | {55000.00,72000.00}
 Sales       | {70000.00,65000.00}
 HR          | {60000.00}
(4 rows)

auca_database=# SELECT department, ARRAY_AGG(first_name ORDER BY last_name) AS employees
FROM employees
GROUP BY department;
 department  |     employees
-------------+--------------------
 Engineering | {Alice,George,Bob}
 HR          | {Hannah}
 Marketing   | {Ethan,Fiona}
 Sales       | {Charlie,Diana}
(4 rows)

auca_database=# SELECT
    department,
    STDDEV(salary) AS salary_std_dev,
    VARIANCE(salary) AS salary_variance
FROM employees
GROUP BY department;
 department  |   salary_std_dev   |    salary_variance
-------------+--------------------+------------------------
 Engineering |     18027.75637732 |     325000000.00000000
 Marketing   | 12020.815280171308 | 144500000.000000000000
 Sales       |  3535.533905932738 |  12500000.000000000000
 HR          |                    |
(4 rows)

auca_database=# SELECT CORR(experience_years, salary) AS experience_salary_correlation
FROM employees;
 experience_salary_correlation
-------------------------------
            0.2585811732508528
(1 row)

auca_database=# SELECT
    category,
    COUNT(*) AS number_of_products,
    SUM(price) AS total_value,
    AVG(price) AS average_price
FROM products
GROUP BY category;
auca_database=# SELECT
    EXTRACT(YEAR FROM sale_date) AS year,
    EXTRACT(QUARTER FROM sale_date) AS quarter,
    COUNT(*) AS total_sales,
    SUM(amount) AS total_revenue
FROM sales
GROUP BY EXTRACT(YEAR FROM sale_date), EXTRACT(QUARTER FROM sale_date)
ORDER BY year, quarter;
 year | quarter | total_sales | total_revenue
------+---------+-------------+---------------
 2024 |       1 |           4 |       6500.00
 2024 |       2 |           1 |       2200.00
(2 rows)

auca_database=# SELECT
    CASE
        WHEN age < 30 THEN 'Under 30'
        WHEN age BETWEEN 30 AND 50 THEN '30-50'
        ELSE 'Over 50'
    END AS age_group,
    COUNT(*) AS employee_count,
    AVG(salary) AS avg_salary
FROM employees
GROUP BY
    CASE
        WHEN age < 30 THEN 'Under 30'
        WHEN age BETWEEN 30 AND 50 THEN '30-50'
        ELSE 'Over 50'
    END;
 age_group | employee_count |     avg_salary
-----------+----------------+--------------------
 Under 30  |              2 | 83500.000000000000
 30-50     |              6 | 83333.333333333333
(2 rows)

auca_database=# SELECT
    department,
    COUNT(*) AS employee_count
FROM employees
GROUP BY department
HAVING COUNT(*) > 5;
 department | employee_count
------------+----------------
(0 rows)

auca_database=# SELECT
    product_id,
    AVG(rating) AS avg_rating,
    COUNT(*) AS review_count
FROM product_reviews
GROUP BY product_id
HAVING AVG(rating) > 4.0 AND COUNT(*) >= 10;
 product_id | avg_rating | review_count
------------+------------+--------------
(0 rows)

auca_database=# SELECT department, AVG(salary) AS dept_avg_salary
FROM employees
GROUP BY department;
 department  |   dept_avg_salary
-------------+---------------------
 Engineering | 115000.000000000000
 Marketing   |  63500.000000000000
 Sales       |  67500.000000000000
 HR          |  60000.000000000000
(4 rows)

auca_database=# SELECT
    employee_id,
    first_name,
    department,
    salary,
    AVG(salary) OVER (PARTITION BY department) AS dept_avg_salary
FROM employees;
auca_database=# SELECT
    COUNT(*) AS total_rows,
    COUNT(email) AS non_null_emails,
    COUNT(*) - COUNT(email) AS null_emails
FROM employees;
 total_rows | non_null_emails | null_emails
------------+-----------------+-------------
          8 |               7 |           1
(1 row)

auca_database=# SELECT
    SUM(bonus) AS total_bonus,        -- NULLs ignored
    AVG(bonus) AS avg_bonus,          -- NULLs ignored
    COUNT(bonus) AS employees_with_bonus
FROM employees;
 total_bonus |       avg_bonus       | employees_with_bonus
-------------+-----------------------+----------------------
    16500.00 | 3300.0000000000000000 |                    5
(1 row)

auca_database=# SELECT
    department,
    COUNT(*) AS employee_count,
    MIN(salary) AS min_salary,
    MAX(salary) AS max_salary,
    AVG(salary) AS avg_salary,
    STDDEV(salary) AS salary_std_dev
FROM employees
GROUP BY department
ORDER BY avg_salary DESC;
auca_database=# SELECT
    department,
    COUNT(*) AS total_employees,
    COUNT(CASE WHEN salary > 50000 THEN 1 END) AS high_earners,
    COUNT(CASE WHEN hire_date > '2023-01-01' THEN 1 END) AS recent_hires
FROM employees
GROUP BY department;
 department  | total_employees | high_earners | recent_hires
-------------+-----------------+--------------+--------------
 Engineering |               3 |            3 |            0
 Marketing   |               2 |            2 |            2
 Sales       |               2 |            2 |            0
 HR          |               1 |            1 |            0
(4 rows)

auca_database=# SELECT
    department,
    COUNT(*) AS dept_count,
    COUNT(*)::FLOAT / (SELECT COUNT(*) FROM employees) * 100 AS percentage
FROM employees
GROUP BY department
ORDER BY percentage DESC;
 department  | dept_count | percentage
-------------+------------+------------
 Engineering |          3 |       37.5
 Marketing   |          2 |         25
 Sales       |          2 |         25
 HR          |          1 |       12.5
(4 rows)

auca_database=#